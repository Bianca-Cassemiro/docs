---
id: data-transfer-oracles
title: Data Transfer Oracles
pagination_label: Data Transfer Oracles
sidebar_label: Data Transfer Oracles
description: Helium Data Transfer Oracles Documentation
image: https://docs.helium.com/img/link-image.png
slug: /oracles/data-transfer-oracles
---

import useBaseUrl from '@docusaurus/useBaseUrl'
import LegacyContentBanner from '@site/src/theme/LegacyContentBanner'

<LegacyContentBanner />

Moving the entire data transfer logic off-chain to Oracles will increase scalability and reduce
points of failure.

## LoRaWAN Network Server Streamlining

In contrast to its operations on the Helium L1, the LoRaWAN Network Server (LNS) assumes a more refined role within Solana, prioritizing the execution of LoRaWAN-specific functions devoid of the overhead associated with administering blockchain-specific tasks. Post the acquisition of Organizationally Unique Identifier (OUI) and slabs, the LNS is mandated to communicate routing information for the devices within their network to the Config Service. Optionally, the LNS can curate an allow-list, enabling selective acceptance of packets, such as those originating from enabled devices or those with a sufficient Data Credit (DC) balance.

This update aligns the responsibilities of a Helium LNS more closely with those of a conventional LNS, thereby simplifying integrations with existing LNS systems and facilitating the expansion of the Helium Network.

## Config Service

The Config Service keeps track of all routing rules for all devices connected to the Helium Network,
aggregating from the LNSs into a database of routes that propagate to each Packet Router. The Config
Service immediately updates the Packet Routers whenever it receives an update.

The Packet Verifier uses the Config Service to fetch the list of OUIs, wallet addresses per gateway,
and wallet addresses per OUI.

## Packet Router Service

The Packet Routers are responsible for routing packets received from Hotspots to the appropriate
LNS. This streamlined service follows the routing rules given to it by the Config Service.

If a Packet Router can match a received packet to a defined route, it will forward that message to
the appropriate LNS and submit a packet report to the Packet Reports Database.

Each packet report includes OUI, network ID, region, gateway, and payload hash metadata. The full
definition can be found
[here](https://github.com/helium/proto/blob/master/src/service/packet_router.proto#L8).

## Load Balancing Service

Hotspots interface directly with Load Balancers, helping the Helium Network scale horizontally when
needed.

## Packet Verifier Service

The Packet Verifier verifies the submitted packets. Its primary responsibilities are to:

- Confirm that each OUI and the associated LNS have enough DC to pay for the packets received.
  - If a given OUI does not, the Packet Verifier will inform the Config Service that it should
    disable the associated routes.
  - Once a disabled OUI has a positive DC balance, it will re-enable the associated routes.
- Confirm that the Message Integrity Code (MIC) check passes.
- Process reports into a separate database of verified and denied reports (denied reports include
  the cause of denial).
- Based on data transfer, calculate Rewards and the amount of DC to debit from each wallet
  associated with an OUI.

```mermaid
flowchart TB;
    subgraph hotspots[Hotspots]
      direction TB
      hotspot1[Hotspot 1] & hotspot2[Hotspot 2] & hotspot3[Hotspot 3]
    end

    hotspots -->|Send Packets| loadBalancer(Load Balancer);
    loadBalancer --> packerRouters(Packet Routers);

    configService(Config Service) -->|Routes| packerRouters;
    packerRouters --> rawReportsDB[(Raw Packet Reports)];

    packerRouters -->|Forward packets to appropriate LNS| lns[LoRaWAN Network Servers];
    lns --->|Routes for a given LNS| configService;

    rawReportsDB ---> packetVerfier(Packet Verfier);
    packetVerfier --> verfiedDataTransferReportsDB[(Verfied Data Transfer Reports)];
    verfiedDataTransferReportsDB --> iotRewardsService(IOT Rewards Service);

    packetVerfier -->|Disables/Enables LNS Routes based on DC balance| configService;
```
